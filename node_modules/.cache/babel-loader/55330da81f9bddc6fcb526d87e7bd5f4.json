{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\Alika\\\\Desktop\\\\VCH_Smith\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\Alika\\\\Desktop\\\\VCH_Smith\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:\\\\Users\\\\Alika\\\\Desktop\\\\VCH_Smith\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Alika\\\\Desktop\\\\VCH_Smith\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\Alika\\\\Desktop\\\\VCH_Smith\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Alika\\\\Desktop\\\\VCH_Smith\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Alika\\\\Desktop\\\\VCH_Smith\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\Alika\\\\Desktop\\\\VCH_Smith\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"C:\\\\Users\\\\Alika\\\\Desktop\\\\VCH_Smith\\\\src\\\\containers\\\\TrialQ.js\";\nimport React, { Component } from 'react';\nimport './TrialQ.css';\nimport { Redirect } from \"react-router-dom\";\nimport { createStim, createGabor } from \"../Stim.js\";\nimport { QuestCreate, QuestRecompute, QuestTrials, QuestUpdate, QuestStimulate, QuestMean, QuestMode, QuestSd, QuestP, QuestPdf, QuestQuantile, PAL_Gumbel } from \"../Quest.js\";\nimport { ch_QuestBetaAnalysis, process_data, gumbel_intensities } from \"../VisualQuest.js\";\nimport { connect } from 'react-redux';\nimport { add_array as _add_array, add_response_q_1 as _add_response_q_, add_response_time_q_1 as _add_response_time_q_, add_contrast_q_1 as _add_contrast_q_, add_response_q_2 as _add_response_q_2, add_response_time_q_2 as _add_response_time_q_2, add_contrast_q_2 as _add_contrast_q_2, add_object as _add_object } from '../actions/data';\n\nvar TrialQ =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(TrialQ, _Component);\n\n  function TrialQ(props) {\n    var _this;\n\n    _classCallCheck(this, TrialQ);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(TrialQ).call(this, props));\n    _this.keyFunction = _this.keyFunction.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.create_noise = _this.create_noise.bind(_assertThisInitialized(_assertThisInitialized(_this))); // this.process_data = this.process_data.bind(this);\n    // this.gumbel_intensities = this.gumbel_intensities.bind(this);\n\n    _this.state = {\n      continue: false,\n      counter: 0,\n      counter2: 0,\n      change: false,\n      rating_img: false,\n      rating_window: false,\n      responses_q_1: [],\n      contrast_array_q_1: [],\n      response_time_q_1: [],\n      responses_q_2: [],\n      contrast_array_q_2: [],\n      response_time_q_2: [],\n      time_window: false,\n      time_window_start: 0,\n      limit: 100,\n      currentQ: 1 //1 for contrast 1 and 2 for contrast 2\n\n    };\n    _this.canvasRef = React.createRef();\n    _this.audioContext = new AudioContext();\n    return _this;\n  }\n\n  _createClass(TrialQ, [{\n    key: \"create_noise\",\n    value: function create_noise(audioContext) {\n      var end = 5; // var contrast_block = tt1;\n\n      var index1 = 0;\n      var index2 = 0;\n      var total = 0;\n\n      var SimplexNoise = require('simplex-noise');\n\n      var simplex = new SimplexNoise(),\n          canvas = document.getElementById('c'),\n          ctx = canvas.getContext('2d'),\n          imgdata = ctx.getImageData(0, 0, canvas.width, canvas.height),\n          data = imgdata.data,\n          t = 0; //initializing QUEST\n\n      var tGuess = 0.5,\n          tGuessSd = 0.1,\n          pThreshold = 0.75,\n          beta = 3.5,\n          delta = 0.01,\n          gamma = 0.01,\n          grain = 0.001,\n          dim = 1000,\n          range = 20;\n      var q_1 = QuestCreate(tGuess, tGuessSd, pThreshold, beta, delta, gamma, grain, range);\n      var q_2 = QuestCreate(tGuess, tGuessSd, pThreshold, beta, delta, gamma, grain, range);\n      var stim = createStim();\n      var stimulus_blank = createGabor(stim, 0);\n      var stimulus;\n      var jitter = Math.floor(Math.random() * 50); //jitter tone presentation 0-500ms per trial\n\n      var start_time = 100;\n      var contrast = 0;\n      var intervalId = undefined;\n      var that = this;\n      var seconds = 0;\n      var img = new Image();\n\n      function vis_quest() {\n        return _vis_quest.apply(this, arguments);\n      }\n\n      function _vis_quest() {\n        _vis_quest = _asyncToGenerator(\n        /*#__PURE__*/\n        _regeneratorRuntime.mark(function _callee() {\n          var seconds, x, y, r, recWidth, recHeight, xPos, yPos, returnStruct, g;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  if (t == start_time + jitter) {\n                    index1 = that.state.counter;\n                    index2 = that.state.counter2;\n                    total = index1 + index2;\n                    console.log(QuestQuantile(q_1), QuestQuantile(q_2)); // determining which staircase to use\n\n                    if (index1 == index2) {\n                      that.setState({\n                        //current staircase is 1\n                        currentQ: 1\n                      });\n                    }\n\n                    if (index1 != index2) {\n                      index2++;\n                      that.setState({\n                        //current staircase is 2\n                        currentQ: 2\n                      });\n                    }\n\n                    if (that.state.currentQ == 1) {\n                      if (index1 = 0) {\n                        contrast = tGuess + .3;\n                      } else {\n                        contrast = QuestQuantile(q_1);\n                      }\n                    }\n\n                    if (that.state.currentQ == 2) {\n                      if (index2 = 0) {\n                        contrast = tGuess - 0.3;\n                      } else {\n                        contrast = QuestQuantile(q_2);\n                      }\n                    }\n\n                    console.log(contrast);\n                    seconds = new Date().getTime() / 1000; // console.log(\"time on \", seconds);\n\n                    that.setState({\n                      rating_window: true,\n                      time_window: true,\n                      time_window_start: seconds\n                    });\n                    console.log(\"for 1\", that.state.responses_q_1, that.state.contrast_array_q_1);\n                    console.log(\"for 2\", that.state.responses_q_2, that.state.contrast_array_q_2);\n                    stimulus = createGabor(stim, contrast);\n                    beep(50, 830, 300, audioContext); //beep for arg3 miliseconds\n                  }\n\n                  x = 0;\n\n                case 2:\n                  if (!(x < 256)) {\n                    _context.next = 28;\n                    break;\n                  }\n\n                  y = 0;\n\n                case 4:\n                  if (!(y < 256)) {\n                    _context.next = 25;\n                    break;\n                  }\n\n                  if (!(t == start_time + jitter || t == start_time + jitter + 1 || t == start_time + jitter + 2 || t == start_time + jitter + 3 || t == start_time + jitter + 4 || t == start_time + jitter + 5 || t == start_time + jitter + 6 || t == start_time + jitter + 7 || t == start_time + jitter + 8 || t == start_time + jitter + 9 || t == start_time + jitter + 10 || t == start_time + jitter + 11 || t == start_time + jitter + 12 || t == start_time + jitter + 13 || t == start_time + jitter + 14 || t == start_time + jitter + 15 || t == start_time + jitter + 16 || t == start_time + jitter + 17 || t == start_time + jitter + 18 || t == start_time + jitter + 19 || t == start_time + jitter + 20 || t == start_time + jitter + 21 || t == start_time + jitter + 22 || t == start_time + jitter + 23 || t == start_time + jitter + 24 || t == start_time + jitter + 25 || t == start_time + jitter + 26 || t == start_time + jitter + 27 || t == start_time + jitter + 28 || t == start_time + jitter + 29 || t == start_time + jitter + 30)) {\n                    _context.next = 14;\n                    break;\n                  }\n\n                  if (t == start_time + jitter + 30) {\n                    t = 0; //during beep show signal, then reset timer to 0\n                  }\n\n                  r = simplex.noise3D(x / 8, y / 8, t / 8) * 0.4 + 0.35;\n                  data[(x + y * 256) * 4 + 0] = stim.alpha * stimulus[(x + y * 256) * 4 + 0] + (1 - stim.alpha) * r * 250;\n                  data[(x + y * 256) * 4 + 1] = stim.alpha * stimulus[(x + y * 256) * 4 + 1] + (1 - stim.alpha) * r * 250;\n                  data[(x + y * 256) * 4 + 2] = stim.alpha * stimulus[(x + y * 256) * 4 + 2] + (1 - stim.alpha) * r * 250;\n                  data[(x + y * 256) * 4 + 3] = 255;\n                  _context.next = 22;\n                  break;\n\n                case 14:\n                  seconds = new Date().getTime() / 1000;\n\n                  if (!(that.state.time_window_start < seconds && that.state.time_window_start > seconds - 0.75)) {\n                    _context.next = 21;\n                    break;\n                  }\n\n                  data[(x + y * 256) * 4 + 0] = 0;\n                  data[(x + y * 256) * 4 + 1] = 0;\n                  data[(x + y * 256) * 4 + 2] = 0;\n                  data[(x + y * 256) * 4 + 3] = 0;\n                  return _context.abrupt(\"continue\", 22);\n\n                case 21:\n                  if (that.state.time_window_start + 2 == seconds) {\n                    that.setState({\n                      time_window: false,\n                      rating_img: false\n                    });\n\n                    if (that.state.currentQ == 1) {\n                      if (that.state.contrast_array_q_1.length < that.state.responses_q_1.length) {\n                        that.setState({\n                          contrast_array_q_1: that.state.contrast_array_q_1.concat([contrast])\n                        });\n                        that.setState({\n                          change: true\n                        });\n                      }\n                    }\n\n                    if (that.state.currentQ == 2) {\n                      if (that.state.contrast_array_q_2.length < that.state.responses_q_2.length) {\n                        that.setState({\n                          contrast_array_q_2: that.state.contrast_array_q_2.concat([contrast])\n                        });\n                        that.setState({\n                          change: true\n                        });\n                      }\n                    }\n\n                    r = simplex.noise3D(x / 8, y / 8, t / 8) * 0.4 + 0.35;\n                    data[(x + y * 256) * 4 + 0] = stim.alpha * stimulus_blank[(x + y * 256) * 4 + 0] + (1 - stim.alpha) * r * 250;\n                    data[(x + y * 256) * 4 + 1] = stim.alpha * stimulus_blank[(x + y * 256) * 4 + 1] + (1 - stim.alpha) * r * 250;\n                    data[(x + y * 256) * 4 + 2] = stim.alpha * stimulus_blank[(x + y * 256) * 4 + 2] + (1 - stim.alpha) * r * 250;\n                    data[(x + y * 256) * 4 + 3] = 255; //if there is no beep, show blank signal\n                    // console.log(\"time off \", seconds);\n                  } else {\n                    r = simplex.noise3D(x / 8, y / 8, t / 8) * 0.4 + 0.35;\n                    data[(x + y * 256) * 4 + 0] = stim.alpha * stimulus_blank[(x + y * 256) * 4 + 0] + (1 - stim.alpha) * r * 250;\n                    data[(x + y * 256) * 4 + 1] = stim.alpha * stimulus_blank[(x + y * 256) * 4 + 1] + (1 - stim.alpha) * r * 250;\n                    data[(x + y * 256) * 4 + 2] = stim.alpha * stimulus_blank[(x + y * 256) * 4 + 2] + (1 - stim.alpha) * r * 250;\n                    data[(x + y * 256) * 4 + 3] = 255; //if there is no beep, show blank signal\n                  }\n\n                case 22:\n                  y++;\n                  _context.next = 4;\n                  break;\n\n                case 25:\n                  x++;\n                  _context.next = 2;\n                  break;\n\n                case 28:\n                  t++;\n                  ctx.putImageData(imgdata, 0, 0);\n                  img.src = \"https://www.shareicon.net/data/256x256/2015/12/04/682310_cross_512x512.png\";\n                  recWidth = canvas.width / 8;\n                  recHeight = canvas.height / 8;\n\n                  if (that.state.time_window_start < seconds && that.state.time_window_start > seconds - 1) {\n                    img.src = \"https://ecdn.teacherspayteachers.com/thumbitem/Visual-Rating-Scale-1-5-2100331-1459950062/original-2100331-1.jpg\";\n                    recWidth = canvas.width / 2;\n                    recHeight = canvas.height / 2;\n                  }\n\n                  xPos = canvas.width / 2 - recWidth / 2;\n                  yPos = canvas.height / 2 - recHeight / 2;\n                  ctx.fillStyle = \"gray\";\n                  ctx.fillRect(xPos, yPos, recWidth, recHeight);\n                  ctx.drawImage(img, xPos, yPos, recWidth, recHeight);\n\n                  if (!(total == end)) {\n                    _context.next = 47;\n                    break;\n                  }\n\n                  returnStruct = process_data(q_1, q_2);\n                  that.props.add_object(returnStruct);\n                  window.cancelAnimationFrame(intervalId);\n                  that.audioContext.close();\n\n                  for (g = 0; g < end; g++) {\n                    that.props.add_response_q_1(that.state.responses_q_1[g]);\n                    that.props.add_response_time_q_1(that.state.response_time_q_1[g]);\n                    that.props.add_contrast_q_1(that.state.contrast_array_q_1[g]);\n                    that.props.add_response_q_2(that.state.responses_q_2[g]);\n                    that.props.add_response_time_q_2(that.state.response_time_q_2[g]);\n                    that.props.add_contrast_q_2(that.state.contrast_array_q_2[g]);\n                  }\n\n                  that.setState({\n                    continue: true\n                  });\n                  return _context.abrupt(\"return\");\n\n                case 47:\n                  if (total < end) {\n                    intervalId = window.requestAnimationFrame(vis_quest);\n\n                    if (that.state.currentQ == 1 && that.state.change == true) {\n                      // console.log(\"changing the q\")\n                      q_1 = QuestUpdate(q_1, [that.state.contrast_array_q_1[that.state.contrast_array_q_1.length - 1]], [that.state.responses_q_1[that.state.responses_q_1.length - 1]]);\n                      console.log(QuestQuantile(q_1));\n                      that.setState({\n                        change: false\n                      });\n                    }\n\n                    if (that.state.currentQ == 2 && that.state.change == true) {\n                      q_2 = QuestUpdate(q_2, that.state.contrast_array_q_1[that.state.contrast_array_q_1.length - 1], that.state.responses_q_1[that.state.responses_q_1.length - 1]);\n                      that.setState({\n                        change: false\n                      });\n                    }\n                  }\n\n                case 48:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }));\n        return _vis_quest.apply(this, arguments);\n      }\n\n      vis_quest.call(that);\n    }\n  }, {\n    key: \"keyFunction\",\n    value: function keyFunction(event) {\n      var seconds = new Date().getTime() / 1000;\n\n      if (event.keyCode === 81 && this.state.time_window == true && this.state.currentQ == 1) {\n        // Set setState\n        this.setState({\n          counter: this.state.counter + 1,\n          responses_q_1: this.state.responses_q_1.concat([1]),\n          response_time_q_1: this.state.response_time_q_1.concat([seconds - this.state.time_window_start]),\n          time_window: false\n        });\n\n        if (this.state.counter == this.state.limit) {\n          this.setState({\n            continue: true\n          });\n        }\n      }\n\n      if (event.keyCode === 81 && this.state.time_window == true && this.state.currentQ == 2) {\n        // Set setState\n        this.setState({\n          counter2: this.state.counter2 + 1,\n          responses_q_2: this.state.responses_q_2.concat([1]),\n          response_time_q_2: this.state.response_time_q_2.concat([seconds - this.state.time_window_start]),\n          time_window: false\n        });\n\n        if (this.state.counter == this.state.limit) {\n          this.setState({\n            continue: true\n          });\n        }\n      }\n\n      if (event.keyCode === 69 && this.state.time_window == true && this.state.currentQ == 1) {\n        this.setState({\n          counter: this.state.counter + 1,\n          responses_q_1: this.state.responses_q_1.concat([0]),\n          response_time_q_1: this.state.response_time_q_1.concat([seconds - this.state.time_window_start]),\n          time_window: false,\n          rating_window: false\n        });\n\n        if (this.state.counter == this.state.limit) {\n          this.setState({\n            continue: true\n          });\n        }\n      }\n\n      if (event.keyCode === 69 && this.state.time_window == true && this.state.currentQ == 2) {\n        this.setState({\n          counter: this.state.counter2 + 1,\n          responses_q_2: this.state.responses_q_2.concat([0]),\n          response_time_q_2: this.state.response_time_q_2.concat([seconds - this.state.time_window_start]),\n          time_window: false,\n          rating_window: false\n        });\n\n        if (this.state.counter == this.state.limit) {\n          this.setState({\n            continue: true\n          });\n        }\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      document.addEventListener(\"keydown\", this.keyFunction, false);\n\n      if (this.state.continue == false) {\n        this.create_noise(this.audioContext);\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      document.removeEventListener(\"keydown\", this.keyFunction, false);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (this.state.continue == true) {\n        // alert(\"Trial completed\")\n        return React.createElement(Redirect, {\n          to: \"/Complete\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 368\n          },\n          __self: this\n        });\n      }\n\n      return React.createElement(\"div\", {\n        className: \"TrialQ\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 372\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"hidden\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 373\n        },\n        __self: this\n      }), React.createElement(\"header\", {\n        className: \"TrialQ-header\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 374\n        },\n        __self: this\n      }, React.createElement(\"canvas\", {\n        id: \"c\",\n        width: \"256\",\n        height: \"256\",\n        style: {\n          zIndex: \"0\",\n          position: \"fixed\",\n          left: \"25%\",\n          width: '50%',\n          height: 'auto'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 375\n        },\n        __self: this\n      }), React.createElement(\"p\", {\n        style: {\n          fontSize: \"10\",\n          fontWeight: \"bold\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 377\n        },\n        __self: this\n      }, \" PLEASE RATE CONFIDENCE 1-5 \"), React.createElement(\"canvas\", {\n        id: \"c2\",\n        width: \"256\",\n        height: \"256\",\n        style: {\n          zIndex: \"1\",\n          position: \"fixed\",\n          left: \"25%\",\n          width: '50%',\n          height: 'auto'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 378\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return TrialQ;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    data: state.data\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    add_response_q_1: function add_response_q_1(element) {\n      return dispatch(_add_response_q_(element));\n    },\n    add_response_time_q_1: function add_response_time_q_1(element) {\n      return dispatch(_add_response_time_q_(element));\n    },\n    add_contrast_q_1: function add_contrast_q_1(element) {\n      return dispatch(_add_contrast_q_(element));\n    },\n    add_response_q_2: function add_response_q_2(element) {\n      return dispatch(_add_response_q_2(element));\n    },\n    add_response_time_q_2: function add_response_time_q_2(element) {\n      return dispatch(_add_response_time_q_2(element));\n    },\n    add_contrast_q_2: function add_contrast_q_2(element) {\n      return dispatch(_add_contrast_q_2(element));\n    },\n    add_array: function add_array(arr) {\n      return dispatch(_add_array(arr));\n    },\n    add_object: function add_object(obj) {\n      return dispatch(_add_object(obj));\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TrialQ);\n\nfunction beep(amp, freq, ms, audioContext) {\n  //amp:0..100, freq in Hz, ms\n  if (!audioContext) return;\n  var osc = audioContext.createOscillator();\n  var gain = audioContext.createGain();\n  osc.connect(gain);\n  osc.value = freq;\n  gain.connect(audioContext.destination);\n  gain.gain.value = amp / 100;\n  osc.start(audioContext.currentTime);\n  osc.stop(audioContext.currentTime + ms / 1000);\n} //array shuffling function, used to randomize order of presentation for different blocks\n\n\nfunction shuffle(array) {\n  var i = 0;\n  var j = 0;\n  var temp = null;\n\n  for (i = array.length - 1; i > 0; i -= 1) {\n    j = Math.floor(Math.random() * (i + 1));\n    temp = array[i];\n    array[i] = array[j];\n    array[j] = temp;\n  }\n}","map":{"version":3,"sources":["C:\\Users\\Alika\\Desktop\\VCH_Smith\\src\\containers\\TrialQ.js"],"names":["React","Component","Redirect","createStim","createGabor","QuestCreate","QuestRecompute","QuestTrials","QuestUpdate","QuestStimulate","QuestMean","QuestMode","QuestSd","QuestP","QuestPdf","QuestQuantile","PAL_Gumbel","ch_QuestBetaAnalysis","process_data","gumbel_intensities","connect","add_array","add_response_q_1","add_response_time_q_1","add_contrast_q_1","add_response_q_2","add_response_time_q_2","add_contrast_q_2","add_object","TrialQ","props","keyFunction","bind","create_noise","state","continue","counter","counter2","change","rating_img","rating_window","responses_q_1","contrast_array_q_1","response_time_q_1","responses_q_2","contrast_array_q_2","response_time_q_2","time_window","time_window_start","limit","currentQ","canvasRef","createRef","audioContext","AudioContext","end","index1","index2","total","SimplexNoise","require","simplex","canvas","document","getElementById","ctx","getContext","imgdata","getImageData","width","height","data","t","tGuess","tGuessSd","pThreshold","beta","delta","gamma","grain","dim","range","q_1","q_2","stim","stimulus_blank","stimulus","jitter","Math","floor","random","start_time","contrast","intervalId","undefined","that","seconds","img","Image","vis_quest","console","log","setState","Date","getTime","beep","x","y","r","noise3D","alpha","length","concat","putImageData","src","recWidth","recHeight","xPos","yPos","fillStyle","fillRect","drawImage","returnStruct","window","cancelAnimationFrame","close","g","requestAnimationFrame","call","event","keyCode","addEventListener","removeEventListener","zIndex","position","left","fontSize","fontWeight","mapStateToProps","mapDispatchToProps","dispatch","element","arr","obj","amp","freq","ms","osc","createOscillator","gain","createGain","value","destination","start","currentTime","stop","shuffle","array","i","j","temp"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAO,cAAP;AACA,SAASC,QAAT,QAAyB,kBAAzB;AACA,SAASC,UAAT,EAAqBC,WAArB,QAAwC,YAAxC;AACA,SAASC,WAAT,EAAsBC,cAAtB,EAAsCC,WAAtC,EAAmDC,WAAnD,EAAgEC,cAAhE,EAAgFC,SAAhF,EAA2FC,SAA3F,EAAsGC,OAAtG,EAA+GC,MAA/G,EAAuHC,QAAvH,EAAiIC,aAAjI,EAAgJC,UAAhJ,QAAkK,aAAlK;AACA,SAASC,oBAAT,EAA+BC,YAA/B,EAA6CC,kBAA7C,QAAuE,mBAAvE;AAEA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,SAAS,IAATA,UAAT,EAAoBC,gBAAgB,IAAhBA,gBAApB,EAAsCC,qBAAqB,IAArBA,qBAAtC,EAA6DC,gBAAgB,IAAhBA,gBAA7D,EAA+EC,gBAAgB,IAAhBA,iBAA/E,EAAiGC,qBAAqB,IAArBA,sBAAjG,EAAwHC,gBAAgB,IAAhBA,iBAAxH,EAA0IC,UAAU,IAAVA,WAA1I,QAA4J,iBAA5J;;IAEMC,M;;;;;AAEJ,kBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,gFAAMA,KAAN;AACA,UAAKC,WAAL,GAAmB,MAAKA,WAAL,CAAiBC,IAAjB,uDAAnB;AACA,UAAKC,YAAL,GAAoB,MAAKA,YAAL,CAAkBD,IAAlB,uDAApB,CAHiB,CAIjB;AACA;;AACA,UAAKE,KAAL,GAAa;AACXC,MAAAA,QAAQ,EAAE,KADC;AAEXC,MAAAA,OAAO,EAAE,CAFE;AAGXC,MAAAA,QAAQ,EAAE,CAHC;AAIXC,MAAAA,MAAM,EAAE,KAJG;AAKXC,MAAAA,UAAU,EAAE,KALD;AAOXC,MAAAA,aAAa,EAAE,KAPJ;AASXC,MAAAA,aAAa,EAAE,EATJ;AAUXC,MAAAA,kBAAkB,EAAE,EAVT;AAWXC,MAAAA,iBAAiB,EAAE,EAXR;AAaXC,MAAAA,aAAa,EAAE,EAbJ;AAcXC,MAAAA,kBAAkB,EAAE,EAdT;AAeXC,MAAAA,iBAAiB,EAAE,EAfR;AAiBXC,MAAAA,WAAW,EAAE,KAjBF;AAkBXC,MAAAA,iBAAiB,EAAE,CAlBR;AAmBXC,MAAAA,KAAK,EAAE,GAnBI;AAqBXC,MAAAA,QAAQ,EAAE,CArBC,CAqBE;;AArBF,KAAb;AAwBA,UAAKC,SAAL,GAAiBnD,KAAK,CAACoD,SAAN,EAAjB;AACA,UAAKC,YAAL,GAAoB,IAAIC,YAAJ,EAApB;AA/BiB;AAgClB;;;;iCAEYD,Y,EAAc;AAEzB,UAAIE,GAAG,GAAG,CAAV,CAFyB,CAGzB;;AACA,UAAIC,MAAM,GAAG,CAAb;AACA,UAAIC,MAAM,GAAG,CAAb;AACA,UAAIC,KAAK,GAAG,CAAZ;;AAEA,UAAIC,YAAY,GAAGC,OAAO,CAAC,eAAD,CAA1B;;AAEA,UAAIC,OAAO,GAAG,IAAIF,YAAJ,EAAd;AAAA,UACEG,MAAM,GAAGC,QAAQ,CAACC,cAAT,CAAwB,GAAxB,CADX;AAAA,UAEEC,GAAG,GAAGH,MAAM,CAACI,UAAP,CAAkB,IAAlB,CAFR;AAAA,UAGEC,OAAO,GAAGF,GAAG,CAACG,YAAJ,CAAiB,CAAjB,EAAoB,CAApB,EAAuBN,MAAM,CAACO,KAA9B,EAAqCP,MAAM,CAACQ,MAA5C,CAHZ;AAAA,UAIEC,IAAI,GAAGJ,OAAO,CAACI,IAJjB;AAAA,UAKEC,CAAC,GAAG,CALN,CAVyB,CAiBzB;;AACA,UAAIC,MAAM,GAAG,GAAb;AAAA,UACEC,QAAQ,GAAG,GADb;AAAA,UAEEC,UAAU,GAAG,IAFf;AAAA,UAGEC,IAAI,GAAG,GAHT;AAAA,UAIEC,KAAK,GAAG,IAJV;AAAA,UAKEC,KAAK,GAAG,IALV;AAAA,UAMEC,KAAK,GAAG,KANV;AAAA,UAOEC,GAAG,GAAG,IAPR;AAAA,UAQEC,KAAK,GAAG,EARV;AASA,UAAIC,GAAG,GAAG7E,WAAW,CAACoE,MAAD,EAASC,QAAT,EAAmBC,UAAnB,EAA+BC,IAA/B,EAAqCC,KAArC,EAA4CC,KAA5C,EAAmDC,KAAnD,EAA0DE,KAA1D,CAArB;AACA,UAAIE,GAAG,GAAG9E,WAAW,CAACoE,MAAD,EAASC,QAAT,EAAmBC,UAAnB,EAA+BC,IAA/B,EAAqCC,KAArC,EAA4CC,KAA5C,EAAmDC,KAAnD,EAA0DE,KAA1D,CAArB;AAEA,UAAIG,IAAI,GAAGjF,UAAU,EAArB;AACA,UAAIkF,cAAc,GAAGjF,WAAW,CAACgF,IAAD,EAAO,CAAP,CAAhC;AAEA,UAAIE,QAAJ;AACA,UAAIC,MAAM,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,EAA3B,CAAb,CAlCyB,CAkCoB;;AAC7C,UAAIC,UAAU,GAAG,GAAjB;AACA,UAAIC,QAAQ,GAAG,CAAf;AACA,UAAIC,UAAU,GAAGC,SAAjB;AAEA,UAAIC,IAAI,GAAG,IAAX;AACA,UAAIC,OAAO,GAAG,CAAd;AAEA,UAAIC,GAAG,GAAG,IAAIC,KAAJ,EAAV;;AA1CyB,eA4CVC,SA5CU;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA,iCA4CzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAEE,sBAAI3B,CAAC,IAAImB,UAAU,GAAGJ,MAAtB,EAA8B;AAE5B/B,oBAAAA,MAAM,GAAGuC,IAAI,CAAC7D,KAAL,CAAWE,OAApB;AACAqB,oBAAAA,MAAM,GAAGsC,IAAI,CAAC7D,KAAL,CAAWG,QAApB;AAEAqB,oBAAAA,KAAK,GAAGF,MAAM,GAAGC,MAAjB;AAEA2C,oBAAAA,OAAO,CAACC,GAAR,CAAYtF,aAAa,CAACmE,GAAD,CAAzB,EAAgCnE,aAAa,CAACoE,GAAD,CAA7C,EAP4B,CAS5B;;AACA,wBAAI3B,MAAM,IAAIC,MAAd,EAAsB;AACpBsC,sBAAAA,IAAI,CAACO,QAAL,CAAc;AAAc;AAC1BpD,wBAAAA,QAAQ,EAAE;AADE,uBAAd;AAGD;;AAED,wBAAIM,MAAM,IAAIC,MAAd,EAAsB;AACpBA,sBAAAA,MAAM;AACNsC,sBAAAA,IAAI,CAACO,QAAL,CAAc;AAAc;AAC1BpD,wBAAAA,QAAQ,EAAE;AADE,uBAAd;AAGD;;AAED,wBAAI6C,IAAI,CAAC7D,KAAL,CAAWgB,QAAX,IAAuB,CAA3B,EAA8B;AAC5B,0BAAIM,MAAM,GAAG,CAAb,EAAgB;AACdoC,wBAAAA,QAAQ,GAAGnB,MAAM,GAAG,EAApB;AACD,uBAFD,MAGK;AACHmB,wBAAAA,QAAQ,GAAG7E,aAAa,CAACmE,GAAD,CAAxB;AACD;AACF;;AACD,wBAAIa,IAAI,CAAC7D,KAAL,CAAWgB,QAAX,IAAuB,CAA3B,EAA8B;AAC5B,0BAAIO,MAAM,GAAG,CAAb,EAAgB;AACdmC,wBAAAA,QAAQ,GAAGnB,MAAM,GAAG,GAApB;AACD,uBAFD,MAGK;AACHmB,wBAAAA,QAAQ,GAAG7E,aAAa,CAACoE,GAAD,CAAxB;AACD;AACF;;AAEDiB,oBAAAA,OAAO,CAACC,GAAR,CAAYT,QAAZ;AAEII,oBAAAA,OA1CwB,GA0Cd,IAAIO,IAAJ,GAAWC,OAAX,KAAuB,IA1CT,EA4C5B;;AAEAT,oBAAAA,IAAI,CAACO,QAAL,CAAc;AACZ9D,sBAAAA,aAAa,EAAE,IADH;AAEZO,sBAAAA,WAAW,EAAE,IAFD;AAGZC,sBAAAA,iBAAiB,EAAEgD;AAHP,qBAAd;AAMAI,oBAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBN,IAAI,CAAC7D,KAAL,CAAWO,aAAhC,EAA+CsD,IAAI,CAAC7D,KAAL,CAAWQ,kBAA1D;AACA0D,oBAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBN,IAAI,CAAC7D,KAAL,CAAWU,aAAhC,EAA+CmD,IAAI,CAAC7D,KAAL,CAAWW,kBAA1D;AAEAyC,oBAAAA,QAAQ,GAAGlF,WAAW,CAACgF,IAAD,EAAOQ,QAAP,CAAtB;AACAa,oBAAAA,IAAI,CAAC,EAAD,EAAK,GAAL,EAAU,GAAV,EAAepD,YAAf,CAAJ,CAxD4B,CAwDM;AACnC;;AAEQqD,kBAAAA,CA7DX,GA6De,CA7Df;;AAAA;AAAA,wBA6DkBA,CAAC,GAAG,GA7DtB;AAAA;AAAA;AAAA;;AA8DaC,kBAAAA,CA9Db,GA8DiB,CA9DjB;;AAAA;AAAA,wBA8DoBA,CAAC,GAAG,GA9DxB;AAAA;AAAA;AAAA;;AAAA,wBA+DUnC,CAAC,IAAImB,UAAU,GAAGJ,MAAlB,IAA4Bf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,CAAvD,IAA4Df,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,CAAvF,IAA4Ff,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,CAAvH,IAA4Hf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,CAAvJ,IACCf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,CAD5B,IACiCf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,CAD5D,IACiEf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,CAD5F,IACiGf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,CAD5H,IACiIf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,CAD5J,IAECf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,EAF5B,IAEkCf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,EAF7D,IAEmEf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,EAF9F,IAEoGf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,EAF/H,IAEqIf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,EAFhK,IAGCf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,EAH5B,IAGkCf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,EAH7D,IAGmEf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,EAH9F,IAGoGf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,EAH/H,IAGqIf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,EAHhK,IAICf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,EAJ5B,IAIkCf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,EAJ7D,IAImEf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,EAJ9F,IAIoGf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,EAJ/H,IAIqIf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,EAJhK,IAKCf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,EAL5B,IAKkCf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,EAL7D,IAKmEf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,EAL9F,IAKoGf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,EAL/H,IAKqIf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,EALhK,IAMCf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,EArEtC;AAAA;AAAA;AAAA;;AAsEQ,sBAAIf,CAAC,IAAImB,UAAU,GAAGJ,MAAb,GAAsB,EAA/B,EAAmC;AACjCf,oBAAAA,CAAC,GAAG,CAAJ,CADiC,CAEjC;AACD;;AAEGoC,kBAAAA,CA3EZ,GA2EgB/C,OAAO,CAACgD,OAAR,CAAgBH,CAAC,GAAG,CAApB,EAAuBC,CAAC,GAAG,CAA3B,EAA8BnC,CAAC,GAAG,CAAlC,IAAuC,GAAvC,GAA6C,IA3E7D;AA4EQD,kBAAAA,IAAI,CAAC,CAACmC,CAAC,GAAGC,CAAC,GAAG,GAAT,IAAgB,CAAhB,GAAoB,CAArB,CAAJ,GAA8BvB,IAAI,CAAC0B,KAAL,GAAaxB,QAAQ,CAAC,CAACoB,CAAC,GAAGC,CAAC,GAAG,GAAT,IAAgB,CAAhB,GAAoB,CAArB,CAArB,GAA+C,CAAC,IAAIvB,IAAI,CAAC0B,KAAV,IAAmBF,CAAnB,GAAuB,GAApG;AACArC,kBAAAA,IAAI,CAAC,CAACmC,CAAC,GAAGC,CAAC,GAAG,GAAT,IAAgB,CAAhB,GAAoB,CAArB,CAAJ,GAA8BvB,IAAI,CAAC0B,KAAL,GAAaxB,QAAQ,CAAC,CAACoB,CAAC,GAAGC,CAAC,GAAG,GAAT,IAAgB,CAAhB,GAAoB,CAArB,CAArB,GAA+C,CAAC,IAAIvB,IAAI,CAAC0B,KAAV,IAAmBF,CAAnB,GAAuB,GAApG;AACArC,kBAAAA,IAAI,CAAC,CAACmC,CAAC,GAAGC,CAAC,GAAG,GAAT,IAAgB,CAAhB,GAAoB,CAArB,CAAJ,GAA8BvB,IAAI,CAAC0B,KAAL,GAAaxB,QAAQ,CAAC,CAACoB,CAAC,GAAGC,CAAC,GAAG,GAAT,IAAgB,CAAhB,GAAoB,CAArB,CAArB,GAA+C,CAAC,IAAIvB,IAAI,CAAC0B,KAAV,IAAmBF,CAAnB,GAAuB,GAApG;AACArC,kBAAAA,IAAI,CAAC,CAACmC,CAAC,GAAGC,CAAC,GAAG,GAAT,IAAgB,CAAhB,GAAoB,CAArB,CAAJ,GAA8B,GAA9B;AA/ER;AAAA;;AAAA;AAoFQX,kBAAAA,OAAO,GAAG,IAAIO,IAAJ,GAAWC,OAAX,KAAuB,IAAjC;;AApFR,wBAsFYT,IAAI,CAAC7D,KAAL,CAAWc,iBAAX,GAA+BgD,OAA/B,IAA0CD,IAAI,CAAC7D,KAAL,CAAWc,iBAAX,GAA+BgD,OAAO,GAAG,IAtF/F;AAAA;AAAA;AAAA;;AAuFUzB,kBAAAA,IAAI,CAAC,CAACmC,CAAC,GAAGC,CAAC,GAAG,GAAT,IAAgB,CAAhB,GAAoB,CAArB,CAAJ,GAA8B,CAA9B;AACApC,kBAAAA,IAAI,CAAC,CAACmC,CAAC,GAAGC,CAAC,GAAG,GAAT,IAAgB,CAAhB,GAAoB,CAArB,CAAJ,GAA8B,CAA9B;AACApC,kBAAAA,IAAI,CAAC,CAACmC,CAAC,GAAGC,CAAC,GAAG,GAAT,IAAgB,CAAhB,GAAoB,CAArB,CAAJ,GAA8B,CAA9B;AACApC,kBAAAA,IAAI,CAAC,CAACmC,CAAC,GAAGC,CAAC,GAAG,GAAT,IAAgB,CAAhB,GAAoB,CAArB,CAAJ,GAA8B,CAA9B;AA1FV;;AAAA;AA8FQ,sBAAIZ,IAAI,CAAC7D,KAAL,CAAWc,iBAAX,GAA+B,CAA/B,IAAoCgD,OAAxC,EAAiD;AAC/CD,oBAAAA,IAAI,CAACO,QAAL,CAAc;AACZvD,sBAAAA,WAAW,EAAE,KADD;AAEZR,sBAAAA,UAAU,EAAE;AAFA,qBAAd;;AAKA,wBAAIwD,IAAI,CAAC7D,KAAL,CAAWgB,QAAX,IAAuB,CAA3B,EAA8B;AAE5B,0BAAI6C,IAAI,CAAC7D,KAAL,CAAWQ,kBAAX,CAA8BqE,MAA9B,GAAuChB,IAAI,CAAC7D,KAAL,CAAWO,aAAX,CAAyBsE,MAApE,EAA4E;AAC1EhB,wBAAAA,IAAI,CAACO,QAAL,CAAc;AAAE5D,0BAAAA,kBAAkB,EAAEqD,IAAI,CAAC7D,KAAL,CAAWQ,kBAAX,CAA8BsE,MAA9B,CAAqC,CAACpB,QAAD,CAArC;AAAtB,yBAAd;AACAG,wBAAAA,IAAI,CAACO,QAAL,CAAc;AAAEhE,0BAAAA,MAAM,EAAE;AAAV,yBAAd;AACD;AACF;;AAED,wBAAIyD,IAAI,CAAC7D,KAAL,CAAWgB,QAAX,IAAuB,CAA3B,EAA8B;AAE5B,0BAAI6C,IAAI,CAAC7D,KAAL,CAAWW,kBAAX,CAA8BkE,MAA9B,GAAuChB,IAAI,CAAC7D,KAAL,CAAWU,aAAX,CAAyBmE,MAApE,EAA4E;AAC1EhB,wBAAAA,IAAI,CAACO,QAAL,CAAc;AAAEzD,0BAAAA,kBAAkB,EAAEkD,IAAI,CAAC7D,KAAL,CAAWW,kBAAX,CAA8BmE,MAA9B,CAAqC,CAACpB,QAAD,CAArC;AAAtB,yBAAd;AACAG,wBAAAA,IAAI,CAACO,QAAL,CAAc;AAAEhE,0BAAAA,MAAM,EAAE;AAAV,yBAAd;AACD;AACF;;AAEGsE,oBAAAA,CAtB2C,GAsBvC/C,OAAO,CAACgD,OAAR,CAAgBH,CAAC,GAAG,CAApB,EAAuBC,CAAC,GAAG,CAA3B,EAA8BnC,CAAC,GAAG,CAAlC,IAAuC,GAAvC,GAA6C,IAtBN;AAuB/CD,oBAAAA,IAAI,CAAC,CAACmC,CAAC,GAAGC,CAAC,GAAG,GAAT,IAAgB,CAAhB,GAAoB,CAArB,CAAJ,GAA8BvB,IAAI,CAAC0B,KAAL,GAAazB,cAAc,CAAC,CAACqB,CAAC,GAAGC,CAAC,GAAG,GAAT,IAAgB,CAAhB,GAAoB,CAArB,CAA3B,GAAqD,CAAC,IAAIvB,IAAI,CAAC0B,KAAV,IAAmBF,CAAnB,GAAuB,GAA1G;AACArC,oBAAAA,IAAI,CAAC,CAACmC,CAAC,GAAGC,CAAC,GAAG,GAAT,IAAgB,CAAhB,GAAoB,CAArB,CAAJ,GAA8BvB,IAAI,CAAC0B,KAAL,GAAazB,cAAc,CAAC,CAACqB,CAAC,GAAGC,CAAC,GAAG,GAAT,IAAgB,CAAhB,GAAoB,CAArB,CAA3B,GAAqD,CAAC,IAAIvB,IAAI,CAAC0B,KAAV,IAAmBF,CAAnB,GAAuB,GAA1G;AACArC,oBAAAA,IAAI,CAAC,CAACmC,CAAC,GAAGC,CAAC,GAAG,GAAT,IAAgB,CAAhB,GAAoB,CAArB,CAAJ,GAA8BvB,IAAI,CAAC0B,KAAL,GAAazB,cAAc,CAAC,CAACqB,CAAC,GAAGC,CAAC,GAAG,GAAT,IAAgB,CAAhB,GAAoB,CAArB,CAA3B,GAAqD,CAAC,IAAIvB,IAAI,CAAC0B,KAAV,IAAmBF,CAAnB,GAAuB,GAA1G;AACArC,oBAAAA,IAAI,CAAC,CAACmC,CAAC,GAAGC,CAAC,GAAG,GAAT,IAAgB,CAAhB,GAAoB,CAArB,CAAJ,GAA8B,GAA9B,CA1B+C,CA2B/C;AACA;AACD,mBA7BD,MA+BK;AACCC,oBAAAA,CADD,GACK/C,OAAO,CAACgD,OAAR,CAAgBH,CAAC,GAAG,CAApB,EAAuBC,CAAC,GAAG,CAA3B,EAA8BnC,CAAC,GAAG,CAAlC,IAAuC,GAAvC,GAA6C,IADlD;AAEHD,oBAAAA,IAAI,CAAC,CAACmC,CAAC,GAAGC,CAAC,GAAG,GAAT,IAAgB,CAAhB,GAAoB,CAArB,CAAJ,GAA8BvB,IAAI,CAAC0B,KAAL,GAAazB,cAAc,CAAC,CAACqB,CAAC,GAAGC,CAAC,GAAG,GAAT,IAAgB,CAAhB,GAAoB,CAArB,CAA3B,GAAqD,CAAC,IAAIvB,IAAI,CAAC0B,KAAV,IAAmBF,CAAnB,GAAuB,GAA1G;AACArC,oBAAAA,IAAI,CAAC,CAACmC,CAAC,GAAGC,CAAC,GAAG,GAAT,IAAgB,CAAhB,GAAoB,CAArB,CAAJ,GAA8BvB,IAAI,CAAC0B,KAAL,GAAazB,cAAc,CAAC,CAACqB,CAAC,GAAGC,CAAC,GAAG,GAAT,IAAgB,CAAhB,GAAoB,CAArB,CAA3B,GAAqD,CAAC,IAAIvB,IAAI,CAAC0B,KAAV,IAAmBF,CAAnB,GAAuB,GAA1G;AACArC,oBAAAA,IAAI,CAAC,CAACmC,CAAC,GAAGC,CAAC,GAAG,GAAT,IAAgB,CAAhB,GAAoB,CAArB,CAAJ,GAA8BvB,IAAI,CAAC0B,KAAL,GAAazB,cAAc,CAAC,CAACqB,CAAC,GAAGC,CAAC,GAAG,GAAT,IAAgB,CAAhB,GAAoB,CAArB,CAA3B,GAAqD,CAAC,IAAIvB,IAAI,CAAC0B,KAAV,IAAmBF,CAAnB,GAAuB,GAA1G;AACArC,oBAAAA,IAAI,CAAC,CAACmC,CAAC,GAAGC,CAAC,GAAG,GAAT,IAAgB,CAAhB,GAAoB,CAArB,CAAJ,GAA8B,GAA9B,CALG,CAMH;AACD;;AApIT;AA8D6BA,kBAAAA,CAAC,EA9D9B;AAAA;AAAA;;AAAA;AA6D2BD,kBAAAA,CAAC,EA7D5B;AAAA;AAAA;;AAAA;AA4IElC,kBAAAA,CAAC;AACDP,kBAAAA,GAAG,CAACgD,YAAJ,CAAiB9C,OAAjB,EAA0B,CAA1B,EAA6B,CAA7B;AAEA8B,kBAAAA,GAAG,CAACiB,GAAJ,GAAU,4EAAV;AACIC,kBAAAA,QAhJN,GAgJiBrD,MAAM,CAACO,KAAP,GAAe,CAhJhC;AAiJM+C,kBAAAA,SAjJN,GAiJkBtD,MAAM,CAACQ,MAAP,GAAgB,CAjJlC;;AAmJE,sBAAIyB,IAAI,CAAC7D,KAAL,CAAWc,iBAAX,GAA+BgD,OAA/B,IAA0CD,IAAI,CAAC7D,KAAL,CAAWc,iBAAX,GAA+BgD,OAAO,GAAG,CAAvF,EAA0F;AACxFC,oBAAAA,GAAG,CAACiB,GAAJ,GAAU,kHAAV;AACAC,oBAAAA,QAAQ,GAAGrD,MAAM,CAACO,KAAP,GAAc,CAAzB;AACA+C,oBAAAA,SAAS,GAAGtD,MAAM,CAACQ,MAAP,GAAc,CAA1B;AACD;;AAEG+C,kBAAAA,IAzJN,GAyJcvD,MAAM,CAACO,KAAP,GAAe,CAAhB,GAAsB8C,QAAQ,GAAG,CAzJ9C;AA0JMG,kBAAAA,IA1JN,GA0JcxD,MAAM,CAACQ,MAAP,GAAgB,CAAjB,GAAuB8C,SAAS,GAAG,CA1JhD;AA4JEnD,kBAAAA,GAAG,CAACsD,SAAJ,GAAgB,MAAhB;AACAtD,kBAAAA,GAAG,CAACuD,QAAJ,CAAaH,IAAb,EAAmBC,IAAnB,EAAyBH,QAAzB,EAAmCC,SAAnC;AACAnD,kBAAAA,GAAG,CAACwD,SAAJ,CAAcxB,GAAd,EAAmBoB,IAAnB,EAAyBC,IAAzB,EAA+BH,QAA/B,EAAyCC,SAAzC;;AA9JF,wBAgKM1D,KAAK,IAAIH,GAhKf;AAAA;AAAA;AAAA;;AAiKQmE,kBAAAA,YAjKR,GAiKuBxG,YAAY,CAACgE,GAAD,EAAMC,GAAN,CAjKnC;AAkKIY,kBAAAA,IAAI,CAACjE,KAAL,CAAWF,UAAX,CAAsB8F,YAAtB;AACAC,kBAAAA,MAAM,CAACC,oBAAP,CAA4B/B,UAA5B;AACAE,kBAAAA,IAAI,CAAC1C,YAAL,CAAkBwE,KAAlB;;AACA,uBAASC,CAAT,GAAa,CAAb,EAAgBA,CAAC,GAAGvE,GAApB,EAAyBuE,CAAC,EAA1B,EAA8B;AAC5B/B,oBAAAA,IAAI,CAACjE,KAAL,CAAWR,gBAAX,CAA4ByE,IAAI,CAAC7D,KAAL,CAAWO,aAAX,CAAyBqF,CAAzB,CAA5B;AACA/B,oBAAAA,IAAI,CAACjE,KAAL,CAAWP,qBAAX,CAAiCwE,IAAI,CAAC7D,KAAL,CAAWS,iBAAX,CAA6BmF,CAA7B,CAAjC;AACA/B,oBAAAA,IAAI,CAACjE,KAAL,CAAWN,gBAAX,CAA4BuE,IAAI,CAAC7D,KAAL,CAAWQ,kBAAX,CAA8BoF,CAA9B,CAA5B;AACA/B,oBAAAA,IAAI,CAACjE,KAAL,CAAWL,gBAAX,CAA4BsE,IAAI,CAAC7D,KAAL,CAAWU,aAAX,CAAyBkF,CAAzB,CAA5B;AACA/B,oBAAAA,IAAI,CAACjE,KAAL,CAAWJ,qBAAX,CAAiCqE,IAAI,CAAC7D,KAAL,CAAWY,iBAAX,CAA6BgF,CAA7B,CAAjC;AACA/B,oBAAAA,IAAI,CAACjE,KAAL,CAAWH,gBAAX,CAA4BoE,IAAI,CAAC7D,KAAL,CAAWW,kBAAX,CAA8BiF,CAA9B,CAA5B;AACD;;AACD/B,kBAAAA,IAAI,CAACO,QAAL,CAAc;AAAEnE,oBAAAA,QAAQ,EAAE;AAAZ,mBAAd;AA7KJ;;AAAA;AAiLE,sBAAIuB,KAAK,GAAGH,GAAZ,EAAiB;AACfsC,oBAAAA,UAAU,GAAG8B,MAAM,CAACI,qBAAP,CAA6B5B,SAA7B,CAAb;;AAEA,wBAAIJ,IAAI,CAAC7D,KAAL,CAAWgB,QAAX,IAAuB,CAAvB,IAA4B6C,IAAI,CAAC7D,KAAL,CAAWI,MAAX,IAAqB,IAArD,EAA2D;AACzD;AACA4C,sBAAAA,GAAG,GAAG1E,WAAW,CAAC0E,GAAD,EAAM,CAACa,IAAI,CAAC7D,KAAL,CAAWQ,kBAAX,CAA8BqD,IAAI,CAAC7D,KAAL,CAAWQ,kBAAX,CAA8BqE,MAA9B,GAAuC,CAArE,CAAD,CAAN,EAAiF,CAAChB,IAAI,CAAC7D,KAAL,CAAWO,aAAX,CAAyBsD,IAAI,CAAC7D,KAAL,CAAWO,aAAX,CAAyBsE,MAAzB,GAAkC,CAA3D,CAAD,CAAjF,CAAjB;AACAX,sBAAAA,OAAO,CAACC,GAAR,CAAYtF,aAAa,CAACmE,GAAD,CAAzB;AACAa,sBAAAA,IAAI,CAACO,QAAL,CAAc;AAAEhE,wBAAAA,MAAM,EAAE;AAAV,uBAAd;AACD;;AAED,wBAAIyD,IAAI,CAAC7D,KAAL,CAAWgB,QAAX,IAAuB,CAAvB,IAA4B6C,IAAI,CAAC7D,KAAL,CAAWI,MAAX,IAAqB,IAArD,EAA2D;AACzD6C,sBAAAA,GAAG,GAAG3E,WAAW,CAAC2E,GAAD,EAAMY,IAAI,CAAC7D,KAAL,CAAWQ,kBAAX,CAA8BqD,IAAI,CAAC7D,KAAL,CAAWQ,kBAAX,CAA8BqE,MAA9B,GAAuC,CAArE,CAAN,EAA+EhB,IAAI,CAAC7D,KAAL,CAAWO,aAAX,CAAyBsD,IAAI,CAAC7D,KAAL,CAAWO,aAAX,CAAyBsE,MAAzB,GAAkC,CAA3D,CAA/E,CAAjB;AACAhB,sBAAAA,IAAI,CAACO,QAAL,CAAc;AAAEhE,wBAAAA,MAAM,EAAE;AAAV,uBAAd;AACD;AACF;;AA/LH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SA5CyB;AAAA;AAAA;;AA+OzB6D,MAAAA,SAAS,CAAC6B,IAAV,CAAejC,IAAf;AAED;;;gCAEWkC,K,EAAO;AACjB,UAAIjC,OAAO,GAAG,IAAIO,IAAJ,GAAWC,OAAX,KAAuB,IAArC;;AAEA,UAAIyB,KAAK,CAACC,OAAN,KAAkB,EAAlB,IAAwB,KAAKhG,KAAL,CAAWa,WAAX,IAA0B,IAAlD,IAA0D,KAAKb,KAAL,CAAWgB,QAAX,IAAuB,CAArF,EAAwF;AAEtF;AACA,aAAKoD,QAAL,CAAc;AACZlE,UAAAA,OAAO,EAAE,KAAKF,KAAL,CAAWE,OAAX,GAAqB,CADlB;AAEZK,UAAAA,aAAa,EAAE,KAAKP,KAAL,CAAWO,aAAX,CAAyBuE,MAAzB,CAAgC,CAAC,CAAD,CAAhC,CAFH;AAGZrE,UAAAA,iBAAiB,EAAE,KAAKT,KAAL,CAAWS,iBAAX,CAA6BqE,MAA7B,CAAoC,CAAChB,OAAO,GAAG,KAAK9D,KAAL,CAAWc,iBAAtB,CAApC,CAHP;AAIZD,UAAAA,WAAW,EAAE;AAJD,SAAd;;AAOA,YAAI,KAAKb,KAAL,CAAWE,OAAX,IAAsB,KAAKF,KAAL,CAAWe,KAArC,EAA4C;AAC1C,eAAKqD,QAAL,CAAc;AAAEnE,YAAAA,QAAQ,EAAE;AAAZ,WAAd;AACD;AAEF;;AAED,UAAI8F,KAAK,CAACC,OAAN,KAAkB,EAAlB,IAAwB,KAAKhG,KAAL,CAAWa,WAAX,IAA0B,IAAlD,IAA0D,KAAKb,KAAL,CAAWgB,QAAX,IAAuB,CAArF,EAAwF;AAEtF;AACA,aAAKoD,QAAL,CAAc;AACZjE,UAAAA,QAAQ,EAAE,KAAKH,KAAL,CAAWG,QAAX,GAAsB,CADpB;AAEZO,UAAAA,aAAa,EAAE,KAAKV,KAAL,CAAWU,aAAX,CAAyBoE,MAAzB,CAAgC,CAAC,CAAD,CAAhC,CAFH;AAGZlE,UAAAA,iBAAiB,EAAE,KAAKZ,KAAL,CAAWY,iBAAX,CAA6BkE,MAA7B,CAAoC,CAAChB,OAAO,GAAG,KAAK9D,KAAL,CAAWc,iBAAtB,CAApC,CAHP;AAIZD,UAAAA,WAAW,EAAE;AAJD,SAAd;;AAOA,YAAI,KAAKb,KAAL,CAAWE,OAAX,IAAsB,KAAKF,KAAL,CAAWe,KAArC,EAA4C;AAC1C,eAAKqD,QAAL,CAAc;AAAEnE,YAAAA,QAAQ,EAAE;AAAZ,WAAd;AACD;AAEF;;AAED,UAAI8F,KAAK,CAACC,OAAN,KAAkB,EAAlB,IAAwB,KAAKhG,KAAL,CAAWa,WAAX,IAA0B,IAAlD,IAA0D,KAAKb,KAAL,CAAWgB,QAAX,IAAuB,CAArF,EAAwF;AACtF,aAAKoD,QAAL,CAAc;AACZlE,UAAAA,OAAO,EAAE,KAAKF,KAAL,CAAWE,OAAX,GAAqB,CADlB;AAEZK,UAAAA,aAAa,EAAE,KAAKP,KAAL,CAAWO,aAAX,CAAyBuE,MAAzB,CAAgC,CAAC,CAAD,CAAhC,CAFH;AAGZrE,UAAAA,iBAAiB,EAAE,KAAKT,KAAL,CAAWS,iBAAX,CAA6BqE,MAA7B,CAAoC,CAAChB,OAAO,GAAG,KAAK9D,KAAL,CAAWc,iBAAtB,CAApC,CAHP;AAIZD,UAAAA,WAAW,EAAE,KAJD;AAKZP,UAAAA,aAAa,EAAE;AALH,SAAd;;AAQA,YAAI,KAAKN,KAAL,CAAWE,OAAX,IAAsB,KAAKF,KAAL,CAAWe,KAArC,EAA4C;AAC1C,eAAKqD,QAAL,CAAc;AAAEnE,YAAAA,QAAQ,EAAE;AAAZ,WAAd;AACD;AACF;;AAED,UAAI8F,KAAK,CAACC,OAAN,KAAkB,EAAlB,IAAwB,KAAKhG,KAAL,CAAWa,WAAX,IAA0B,IAAlD,IAA0D,KAAKb,KAAL,CAAWgB,QAAX,IAAuB,CAArF,EAAwF;AACtF,aAAKoD,QAAL,CAAc;AACZlE,UAAAA,OAAO,EAAE,KAAKF,KAAL,CAAWG,QAAX,GAAsB,CADnB;AAEZO,UAAAA,aAAa,EAAE,KAAKV,KAAL,CAAWU,aAAX,CAAyBoE,MAAzB,CAAgC,CAAC,CAAD,CAAhC,CAFH;AAGZlE,UAAAA,iBAAiB,EAAE,KAAKZ,KAAL,CAAWY,iBAAX,CAA6BkE,MAA7B,CAAoC,CAAChB,OAAO,GAAG,KAAK9D,KAAL,CAAWc,iBAAtB,CAApC,CAHP;AAIZD,UAAAA,WAAW,EAAE,KAJD;AAKZP,UAAAA,aAAa,EAAE;AALH,SAAd;;AAQA,YAAI,KAAKN,KAAL,CAAWE,OAAX,IAAsB,KAAKF,KAAL,CAAWe,KAArC,EAA4C;AAC1C,eAAKqD,QAAL,CAAc;AAAEnE,YAAAA,QAAQ,EAAE;AAAZ,WAAd;AACD;AACF;AACF;;;wCAEmB;AAClB4B,MAAAA,QAAQ,CAACoE,gBAAT,CAA0B,SAA1B,EAAqC,KAAKpG,WAA1C,EAAuD,KAAvD;;AACA,UAAI,KAAKG,KAAL,CAAWC,QAAX,IAAuB,KAA3B,EAAkC;AAChC,aAAKF,YAAL,CAAkB,KAAKoB,YAAvB;AACD;AACF;;;2CACsB;AACrBU,MAAAA,QAAQ,CAACqE,mBAAT,CAA6B,SAA7B,EAAwC,KAAKrG,WAA7C,EAA0D,KAA1D;AACD;;;6BAEQ;AAEP,UAAI,KAAKG,KAAL,CAAWC,QAAX,IAAuB,IAA3B,EAAiC;AAC/B;AACA,eAAO,oBAAC,QAAD;AAAU,UAAA,EAAE,EAAC,WAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAAP;AACD;;AAED,aACE;AAAK,QAAA,SAAS,EAAC,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAO,QAAA,IAAI,EAAC,QAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EAEE;AAAQ,QAAA,SAAS,EAAC,eAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAQ,QAAA,EAAE,EAAC,GAAX;AAAe,QAAA,KAAK,EAAC,KAArB;AAA2B,QAAA,MAAM,EAAC,KAAlC;AACE,QAAA,KAAK,EAAE;AAAEkG,UAAAA,MAAM,EAAE,GAAV;AAAeC,UAAAA,QAAQ,EAAE,OAAzB;AAAkCC,UAAAA,IAAI,EAAE,KAAxC;AAA+ClE,UAAAA,KAAK,EAAE,KAAtD;AAA6DC,UAAAA,MAAM,EAAE;AAArE,SADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EAGE;AAAG,QAAA,KAAK,EAAE;AAAEkE,UAAAA,QAAQ,EAAE,IAAZ;AAAkBC,UAAAA,UAAU,EAAE;AAA9B,SAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wCAHF,EAIE;AAAQ,QAAA,EAAE,EAAC,IAAX;AAAgB,QAAA,KAAK,EAAC,KAAtB;AAA4B,QAAA,MAAM,EAAC,KAAnC;AACE,QAAA,KAAK,EAAE;AAAEJ,UAAAA,MAAM,EAAE,GAAV;AAAeC,UAAAA,QAAQ,EAAE,OAAzB;AAAkCC,UAAAA,IAAI,EAAE,KAAxC;AAA+ClE,UAAAA,KAAK,EAAE,KAAtD;AAA6DC,UAAAA,MAAM,EAAE;AAArE,SADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAJF,CAFF,CADF;AAYD;;;;EApXkBrE,S;;AAuXrB,IAAMyI,eAAe,GAAG,SAAlBA,eAAkB,CAAAxG,KAAK;AAAA,SAAK;AAChCqC,IAAAA,IAAI,EAAErC,KAAK,CAACqC;AADoB,GAAL;AAAA,CAA7B;;AAIA,IAAMoE,kBAAkB,GAAG,SAArBA,kBAAqB,CAAAC,QAAQ;AAAA,SAAK;AACtCtH,IAAAA,gBAAgB,EAAE,0BAACuH,OAAD;AAAA,aAAaD,QAAQ,CAACtH,gBAAgB,CAACuH,OAAD,CAAjB,CAArB;AAAA,KADoB;AAEtCtH,IAAAA,qBAAqB,EAAE,+BAACsH,OAAD;AAAA,aAAaD,QAAQ,CAACrH,qBAAqB,CAACsH,OAAD,CAAtB,CAArB;AAAA,KAFe;AAGtCrH,IAAAA,gBAAgB,EAAE,0BAACqH,OAAD;AAAA,aAAaD,QAAQ,CAACpH,gBAAgB,CAACqH,OAAD,CAAjB,CAArB;AAAA,KAHoB;AAItCpH,IAAAA,gBAAgB,EAAE,0BAACoH,OAAD;AAAA,aAAaD,QAAQ,CAACnH,iBAAgB,CAACoH,OAAD,CAAjB,CAArB;AAAA,KAJoB;AAKtCnH,IAAAA,qBAAqB,EAAE,+BAACmH,OAAD;AAAA,aAAaD,QAAQ,CAAClH,sBAAqB,CAACmH,OAAD,CAAtB,CAArB;AAAA,KALe;AAMtClH,IAAAA,gBAAgB,EAAE,0BAACkH,OAAD;AAAA,aAAaD,QAAQ,CAACjH,iBAAgB,CAACkH,OAAD,CAAjB,CAArB;AAAA,KANoB;AAOtCxH,IAAAA,SAAS,EAAE,mBAACyH,GAAD;AAAA,aAASF,QAAQ,CAACvH,UAAS,CAACyH,GAAD,CAAV,CAAjB;AAAA,KAP2B;AAQtClH,IAAAA,UAAU,EAAE,oBAACmH,GAAD;AAAA,aAASH,QAAQ,CAAChH,WAAU,CAACmH,GAAD,CAAX,CAAjB;AAAA;AAR0B,GAAL;AAAA,CAAnC;;AAYA,eAAe3H,OAAO,CAACsH,eAAD,EAAkBC,kBAAlB,CAAP,CAA6C9G,MAA7C,CAAf;;AAGA,SAAS4E,IAAT,CAAcuC,GAAd,EAAmBC,IAAnB,EAAyBC,EAAzB,EAA6B7F,YAA7B,EAA2C;AAAC;AAC1C,MAAI,CAACA,YAAL,EAAmB;AACnB,MAAI8F,GAAG,GAAG9F,YAAY,CAAC+F,gBAAb,EAAV;AACA,MAAIC,IAAI,GAAGhG,YAAY,CAACiG,UAAb,EAAX;AACAH,EAAAA,GAAG,CAAC/H,OAAJ,CAAYiI,IAAZ;AACAF,EAAAA,GAAG,CAACI,KAAJ,GAAYN,IAAZ;AACAI,EAAAA,IAAI,CAACjI,OAAL,CAAaiC,YAAY,CAACmG,WAA1B;AACAH,EAAAA,IAAI,CAACA,IAAL,CAAUE,KAAV,GAAkBP,GAAG,GAAG,GAAxB;AACAG,EAAAA,GAAG,CAACM,KAAJ,CAAUpG,YAAY,CAACqG,WAAvB;AACAP,EAAAA,GAAG,CAACQ,IAAJ,CAAStG,YAAY,CAACqG,WAAb,GAA2BR,EAAE,GAAG,IAAzC;AACD,C,CAED;;;AACA,SAASU,OAAT,CAAiBC,KAAjB,EAAwB;AACtB,MAAIC,CAAC,GAAG,CAAR;AACA,MAAIC,CAAC,GAAG,CAAR;AACA,MAAIC,IAAI,GAAG,IAAX;;AAEA,OAAKF,CAAC,GAAGD,KAAK,CAAC9C,MAAN,GAAe,CAAxB,EAA2B+C,CAAC,GAAG,CAA/B,EAAkCA,CAAC,IAAI,CAAvC,EAA0C;AACxCC,IAAAA,CAAC,GAAGvE,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,MAAiBoE,CAAC,GAAG,CAArB,CAAX,CAAJ;AACAE,IAAAA,IAAI,GAAGH,KAAK,CAACC,CAAD,CAAZ;AACAD,IAAAA,KAAK,CAACC,CAAD,CAAL,GAAWD,KAAK,CAACE,CAAD,CAAhB;AACAF,IAAAA,KAAK,CAACE,CAAD,CAAL,GAAWC,IAAX;AACD;AACF","sourcesContent":["import React, { Component } from 'react';\r\nimport './TrialQ.css';\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { createStim, createGabor } from \"../Stim.js\"\r\nimport { QuestCreate, QuestRecompute, QuestTrials, QuestUpdate, QuestStimulate, QuestMean, QuestMode, QuestSd, QuestP, QuestPdf, QuestQuantile, PAL_Gumbel } from \"../Quest.js\"\r\nimport { ch_QuestBetaAnalysis, process_data, gumbel_intensities } from \"../VisualQuest.js\"\r\n\r\nimport { connect } from 'react-redux'\r\nimport { add_array, add_response_q_1, add_response_time_q_1, add_contrast_q_1, add_response_q_2, add_response_time_q_2, add_contrast_q_2, add_object } from '../actions/data'\r\n\r\nclass TrialQ extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.keyFunction = this.keyFunction.bind(this);\r\n    this.create_noise = this.create_noise.bind(this);\r\n    // this.process_data = this.process_data.bind(this);\r\n    // this.gumbel_intensities = this.gumbel_intensities.bind(this);\r\n    this.state = {\r\n      continue: false,\r\n      counter: 0,\r\n      counter2: 0,\r\n      change: false,\r\n      rating_img: false, \r\n\r\n      rating_window: false,\r\n\r\n      responses_q_1: [],\r\n      contrast_array_q_1: [],\r\n      response_time_q_1: [],\r\n\r\n      responses_q_2: [],\r\n      contrast_array_q_2: [],\r\n      response_time_q_2: [],\r\n\r\n      time_window: false,\r\n      time_window_start: 0,\r\n      limit: 100,\r\n\r\n      currentQ: 1, //1 for contrast 1 and 2 for contrast 2\r\n\r\n    }\r\n    this.canvasRef = React.createRef();\r\n    this.audioContext = new AudioContext();\r\n  }\r\n\r\n  create_noise(audioContext) {\r\n\r\n    var end = 5;\r\n    // var contrast_block = tt1;\r\n    var index1 = 0;\r\n    var index2 = 0;\r\n    var total = 0;\r\n\r\n    var SimplexNoise = require('simplex-noise');\r\n\r\n    var simplex = new SimplexNoise(),\r\n      canvas = document.getElementById('c'),\r\n      ctx = canvas.getContext('2d'),\r\n      imgdata = ctx.getImageData(0, 0, canvas.width, canvas.height),\r\n      data = imgdata.data,\r\n      t = 0;\r\n\r\n    //initializing QUEST\r\n    var tGuess = 0.5,\r\n      tGuessSd = 0.1,\r\n      pThreshold = 0.75,\r\n      beta = 3.5,\r\n      delta = 0.01,\r\n      gamma = 0.01,\r\n      grain = 0.001,\r\n      dim = 1000,\r\n      range = 20;\r\n    var q_1 = QuestCreate(tGuess, tGuessSd, pThreshold, beta, delta, gamma, grain, range);\r\n    var q_2 = QuestCreate(tGuess, tGuessSd, pThreshold, beta, delta, gamma, grain, range);\r\n\r\n    var stim = createStim();\r\n    var stimulus_blank = createGabor(stim, 0);\r\n\r\n    var stimulus;\r\n    var jitter = Math.floor(Math.random() * 50); //jitter tone presentation 0-500ms per trial\r\n    var start_time = 100;\r\n    var contrast = 0;\r\n    var intervalId = undefined;\r\n\r\n    var that = this;\r\n    var seconds = 0;\r\n\r\n    var img = new Image();\r\n\r\n    async function vis_quest() {\r\n\r\n      if (t == start_time + jitter) {\r\n\r\n        index1 = that.state.counter;\r\n        index2 = that.state.counter2;\r\n\r\n        total = index1 + index2;\r\n\r\n        console.log(QuestQuantile(q_1), QuestQuantile(q_2));\r\n\r\n        // determining which staircase to use\r\n        if (index1 == index2) {\r\n          that.setState({             //current staircase is 1\r\n            currentQ: 1,\r\n          });\r\n        }\r\n\r\n        if (index1 != index2) {\r\n          index2++;\r\n          that.setState({             //current staircase is 2\r\n            currentQ: 2,\r\n          });\r\n        }\r\n\r\n        if (that.state.currentQ == 1) {\r\n          if (index1 = 0) {\r\n            contrast = tGuess + .3;\r\n          }\r\n          else {\r\n            contrast = QuestQuantile(q_1);\r\n          }\r\n        }\r\n        if (that.state.currentQ == 2) {\r\n          if (index2 = 0) {\r\n            contrast = tGuess - 0.3;\r\n          }\r\n          else {\r\n            contrast = QuestQuantile(q_2);\r\n          }\r\n        }\r\n\r\n        console.log(contrast);\r\n\r\n        var seconds = new Date().getTime() / 1000;\r\n\r\n        // console.log(\"time on \", seconds);\r\n\r\n        that.setState({\r\n          rating_window: true,\r\n          time_window: true,\r\n          time_window_start: seconds,\r\n        });\r\n\r\n        console.log(\"for 1\", that.state.responses_q_1, that.state.contrast_array_q_1);\r\n        console.log(\"for 2\", that.state.responses_q_2, that.state.contrast_array_q_2);\r\n\r\n        stimulus = createGabor(stim, contrast);\r\n        beep(50, 830, 300, audioContext); //beep for arg3 miliseconds\r\n      }\r\n\r\n      for (var x = 0; x < 256; x++) {\r\n        for (var y = 0; y < 256; y++) {\r\n          if (t == start_time + jitter || t == start_time + jitter + 1 || t == start_time + jitter + 2 || t == start_time + jitter + 3 || t == start_time + jitter + 4\r\n            || t == start_time + jitter + 5 || t == start_time + jitter + 6 || t == start_time + jitter + 7 || t == start_time + jitter + 8 || t == start_time + jitter + 9\r\n            || t == start_time + jitter + 10 || t == start_time + jitter + 11 || t == start_time + jitter + 12 || t == start_time + jitter + 13 || t == start_time + jitter + 14\r\n            || t == start_time + jitter + 15 || t == start_time + jitter + 16 || t == start_time + jitter + 17 || t == start_time + jitter + 18 || t == start_time + jitter + 19\r\n            || t == start_time + jitter + 20 || t == start_time + jitter + 21 || t == start_time + jitter + 22 || t == start_time + jitter + 23 || t == start_time + jitter + 24\r\n            || t == start_time + jitter + 25 || t == start_time + jitter + 26 || t == start_time + jitter + 27 || t == start_time + jitter + 28 || t == start_time + jitter + 29\r\n            || t == start_time + jitter + 30) {\r\n            if (t == start_time + jitter + 30) {\r\n              t = 0;\r\n              //during beep show signal, then reset timer to 0\r\n            }\r\n\r\n            var r = simplex.noise3D(x / 8, y / 8, t / 8) * 0.4 + 0.35;\r\n            data[(x + y * 256) * 4 + 0] = stim.alpha * stimulus[(x + y * 256) * 4 + 0] + (1 - stim.alpha) * r * 250;\r\n            data[(x + y * 256) * 4 + 1] = stim.alpha * stimulus[(x + y * 256) * 4 + 1] + (1 - stim.alpha) * r * 250;\r\n            data[(x + y * 256) * 4 + 2] = stim.alpha * stimulus[(x + y * 256) * 4 + 2] + (1 - stim.alpha) * r * 250;\r\n            data[(x + y * 256) * 4 + 3] = 255;\r\n          }\r\n\r\n          else {\r\n\r\n            seconds = new Date().getTime() / 1000\r\n\r\n            if (that.state.time_window_start < seconds && that.state.time_window_start > seconds - 0.75) {\r\n              data[(x + y * 256) * 4 + 0] = 0;\r\n              data[(x + y * 256) * 4 + 1] = 0;\r\n              data[(x + y * 256) * 4 + 2] = 0;\r\n              data[(x + y * 256) * 4 + 3] = 0;\r\n              continue;\r\n            }\r\n\r\n            if (that.state.time_window_start + 2 == seconds) {\r\n              that.setState({\r\n                time_window: false,\r\n                rating_img: false, \r\n              });\r\n\r\n              if (that.state.currentQ == 1) {\r\n\r\n                if (that.state.contrast_array_q_1.length < that.state.responses_q_1.length) {\r\n                  that.setState({ contrast_array_q_1: that.state.contrast_array_q_1.concat([contrast]) });\r\n                  that.setState({ change: true });\r\n                }\r\n              }\r\n\r\n              if (that.state.currentQ == 2) {\r\n\r\n                if (that.state.contrast_array_q_2.length < that.state.responses_q_2.length) {\r\n                  that.setState({ contrast_array_q_2: that.state.contrast_array_q_2.concat([contrast]) });\r\n                  that.setState({ change: true });\r\n                }\r\n              }\r\n\r\n              var r = simplex.noise3D(x / 8, y / 8, t / 8) * 0.4 + 0.35;\r\n              data[(x + y * 256) * 4 + 0] = stim.alpha * stimulus_blank[(x + y * 256) * 4 + 0] + (1 - stim.alpha) * r * 250;\r\n              data[(x + y * 256) * 4 + 1] = stim.alpha * stimulus_blank[(x + y * 256) * 4 + 1] + (1 - stim.alpha) * r * 250;\r\n              data[(x + y * 256) * 4 + 2] = stim.alpha * stimulus_blank[(x + y * 256) * 4 + 2] + (1 - stim.alpha) * r * 250;\r\n              data[(x + y * 256) * 4 + 3] = 255;\r\n              //if there is no beep, show blank signal\r\n              // console.log(\"time off \", seconds);\r\n            }\r\n\r\n            else {\r\n              var r = simplex.noise3D(x / 8, y / 8, t / 8) * 0.4 + 0.35;\r\n              data[(x + y * 256) * 4 + 0] = stim.alpha * stimulus_blank[(x + y * 256) * 4 + 0] + (1 - stim.alpha) * r * 250;\r\n              data[(x + y * 256) * 4 + 1] = stim.alpha * stimulus_blank[(x + y * 256) * 4 + 1] + (1 - stim.alpha) * r * 250;\r\n              data[(x + y * 256) * 4 + 2] = stim.alpha * stimulus_blank[(x + y * 256) * 4 + 2] + (1 - stim.alpha) * r * 250;\r\n              data[(x + y * 256) * 4 + 3] = 255;\r\n              //if there is no beep, show blank signal\r\n            }\r\n\r\n\r\n\r\n          }\r\n        }\r\n      }\r\n\r\n      t++;\r\n      ctx.putImageData(imgdata, 0, 0);\r\n\r\n      img.src = \"https://www.shareicon.net/data/256x256/2015/12/04/682310_cross_512x512.png\";\r\n      var recWidth = canvas.width / 8;\r\n      var recHeight = canvas.height / 8;\r\n\r\n      if (that.state.time_window_start < seconds && that.state.time_window_start > seconds - 1) {\r\n        img.src = \"https://ecdn.teacherspayteachers.com/thumbitem/Visual-Rating-Scale-1-5-2100331-1459950062/original-2100331-1.jpg\"\r\n        recWidth = canvas.width /2;\r\n        recHeight = canvas.height/2;\r\n      }\r\n\r\n      var xPos = (canvas.width / 2) - (recWidth / 2);\r\n      var yPos = (canvas.height / 2) - (recHeight / 2);\r\n      \r\n      ctx.fillStyle = \"gray\";\r\n      ctx.fillRect(xPos, yPos, recWidth, recHeight);\r\n      ctx.drawImage(img, xPos, yPos, recWidth, recHeight);\r\n\r\n      if (total == end) {\r\n        var returnStruct = process_data(q_1, q_2);\r\n        that.props.add_object(returnStruct);\r\n        window.cancelAnimationFrame(intervalId);\r\n        that.audioContext.close();\r\n        for (var g = 0; g < end; g++) {\r\n          that.props.add_response_q_1(that.state.responses_q_1[g]);\r\n          that.props.add_response_time_q_1(that.state.response_time_q_1[g]);\r\n          that.props.add_contrast_q_1(that.state.contrast_array_q_1[g]);\r\n          that.props.add_response_q_2(that.state.responses_q_2[g]);\r\n          that.props.add_response_time_q_2(that.state.response_time_q_2[g]);\r\n          that.props.add_contrast_q_2(that.state.contrast_array_q_2[g]);\r\n        }\r\n        that.setState({ continue: true });\r\n        return;\r\n      }\r\n\r\n      if (total < end) {\r\n        intervalId = window.requestAnimationFrame(vis_quest);\r\n\r\n        if (that.state.currentQ == 1 && that.state.change == true) {\r\n          // console.log(\"changing the q\")\r\n          q_1 = QuestUpdate(q_1, [that.state.contrast_array_q_1[that.state.contrast_array_q_1.length - 1]], [that.state.responses_q_1[that.state.responses_q_1.length - 1]]);\r\n          console.log(QuestQuantile(q_1));\r\n          that.setState({ change: false });\r\n        }\r\n\r\n        if (that.state.currentQ == 2 && that.state.change == true) {\r\n          q_2 = QuestUpdate(q_2, that.state.contrast_array_q_1[that.state.contrast_array_q_1.length - 1], that.state.responses_q_1[that.state.responses_q_1.length - 1]);\r\n          that.setState({ change: false });\r\n        }\r\n      }\r\n\r\n    }\r\n\r\n    vis_quest.call(that);\r\n\r\n  }\r\n\r\n  keyFunction(event) {\r\n    var seconds = new Date().getTime() / 1000\r\n\r\n    if (event.keyCode === 81 && this.state.time_window == true && this.state.currentQ == 1) {\r\n\r\n      // Set setState\r\n      this.setState({\r\n        counter: this.state.counter + 1,\r\n        responses_q_1: this.state.responses_q_1.concat([1]),\r\n        response_time_q_1: this.state.response_time_q_1.concat([seconds - this.state.time_window_start]),\r\n        time_window: false,\r\n      });\r\n\r\n      if (this.state.counter == this.state.limit) {\r\n        this.setState({ continue: true });\r\n      }\r\n\r\n    }\r\n\r\n    if (event.keyCode === 81 && this.state.time_window == true && this.state.currentQ == 2) {\r\n\r\n      // Set setState\r\n      this.setState({\r\n        counter2: this.state.counter2 + 1,\r\n        responses_q_2: this.state.responses_q_2.concat([1]),\r\n        response_time_q_2: this.state.response_time_q_2.concat([seconds - this.state.time_window_start]),\r\n        time_window: false,\r\n      });\r\n\r\n      if (this.state.counter == this.state.limit) {\r\n        this.setState({ continue: true });\r\n      }\r\n\r\n    }\r\n\r\n    if (event.keyCode === 69 && this.state.time_window == true && this.state.currentQ == 1) {\r\n      this.setState({\r\n        counter: this.state.counter + 1,\r\n        responses_q_1: this.state.responses_q_1.concat([0]),\r\n        response_time_q_1: this.state.response_time_q_1.concat([seconds - this.state.time_window_start]),\r\n        time_window: false,\r\n        rating_window: false,\r\n      });\r\n\r\n      if (this.state.counter == this.state.limit) {\r\n        this.setState({ continue: true });\r\n      }\r\n    }\r\n\r\n    if (event.keyCode === 69 && this.state.time_window == true && this.state.currentQ == 2) {\r\n      this.setState({\r\n        counter: this.state.counter2 + 1,\r\n        responses_q_2: this.state.responses_q_2.concat([0]),\r\n        response_time_q_2: this.state.response_time_q_2.concat([seconds - this.state.time_window_start]),\r\n        time_window: false,\r\n        rating_window: false,\r\n      });\r\n\r\n      if (this.state.counter == this.state.limit) {\r\n        this.setState({ continue: true });\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    document.addEventListener(\"keydown\", this.keyFunction, false);\r\n    if (this.state.continue == false) {\r\n      this.create_noise(this.audioContext);\r\n    }\r\n  }\r\n  componentWillUnmount() {\r\n    document.removeEventListener(\"keydown\", this.keyFunction, false);\r\n  }\r\n\r\n  render() {\r\n\r\n    if (this.state.continue == true) {\r\n      // alert(\"Trial completed\")\r\n      return <Redirect to=\"/Complete\" />\r\n    }\r\n\r\n    return (\r\n      <div className=\"TrialQ\">\r\n        <input type=\"hidden\" />\r\n        <header className=\"TrialQ-header\">\r\n          <canvas id=\"c\" width=\"256\" height=\"256\"\r\n            style={{ zIndex: \"0\", position: \"fixed\", left: \"25%\", width: '50%', height: 'auto' }}></canvas>\r\n          <p style={{ fontSize: \"10\", fontWeight: \"bold\" }}> PLEASE RATE CONFIDENCE 1-5 </p>\r\n          <canvas id=\"c2\" width=\"256\" height=\"256\"\r\n            style={{ zIndex: \"1\", position: \"fixed\", left: \"25%\", width: '50%', height: 'auto' }}></canvas>\r\n        </header>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  data: state.data,\r\n})\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  add_response_q_1: (element) => dispatch(add_response_q_1(element)),\r\n  add_response_time_q_1: (element) => dispatch(add_response_time_q_1(element)),\r\n  add_contrast_q_1: (element) => dispatch(add_contrast_q_1(element)),\r\n  add_response_q_2: (element) => dispatch(add_response_q_2(element)),\r\n  add_response_time_q_2: (element) => dispatch(add_response_time_q_2(element)),\r\n  add_contrast_q_2: (element) => dispatch(add_contrast_q_2(element)),\r\n  add_array: (arr) => dispatch(add_array(arr)),\r\n  add_object: (obj) => dispatch(add_object(obj)),\r\n})\r\n\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(TrialQ);\r\n\r\n\r\nfunction beep(amp, freq, ms, audioContext) {//amp:0..100, freq in Hz, ms\r\n  if (!audioContext) return;\r\n  var osc = audioContext.createOscillator();\r\n  var gain = audioContext.createGain();\r\n  osc.connect(gain);\r\n  osc.value = freq;\r\n  gain.connect(audioContext.destination);\r\n  gain.gain.value = amp / 100;\r\n  osc.start(audioContext.currentTime);\r\n  osc.stop(audioContext.currentTime + ms / 1000);\r\n}\r\n\r\n//array shuffling function, used to randomize order of presentation for different blocks\r\nfunction shuffle(array) {\r\n  var i = 0\r\n  var j = 0\r\n  var temp = null\r\n\r\n  for (i = array.length - 1; i > 0; i -= 1) {\r\n    j = Math.floor(Math.random() * (i + 1))\r\n    temp = array[i]\r\n    array[i] = array[j]\r\n    array[j] = temp\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}